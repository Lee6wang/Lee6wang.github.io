---
title: "永磁同步直线电机（PMLSM）的数学建模：与旋转 PMSM 的异同"
date: 2026-01-23 14:00:00 +0800
categories: [Motor Control, Engineering]
tags: [PMLSM, PMSM]
math: true
---

# 永磁同步直线电机（PMLSM）的数学建模：与旋转 PMSM 的异同

## 写在前面

本文围绕永磁同步直线电机（PMLSM）的数学建模展开，建模框架参照旋转永磁同步电机（PMSM）的经典方法进行迁移与整理，并着重补充直线电机特有的几何量与物理映射关系。

核心思路在于：将旋转 PMSM 中成熟的"ABC→αβ→dq"坐标变换体系**直接迁移**至直线电机，仅需对以下变量作等效替换：

1. 角度变量：$\theta \rightarrow x$（位置）  
2. 速度变量：$\omega \rightarrow v$（线速度）  
3. 输出物理量：$T \rightarrow F$（推力）

在此替换下，电磁方程的基本形式保持一致。

---

## 一、三相 PMLSM 的基本数学模型（ABC 坐标系）

本节建立 PMLSM 在自然坐标系下的基本方程组，包括电压方程、磁链方程、电磁推力方程及机械运动方程。在推导之前，首先从结构与磁场的角度说明 PMLSM 与旋转 PMSM 之间的内在联系。

为简化分析，假设三相 PMLSM 为理想电机，满足以下条件：

- 忽略铁芯饱和
- 不计涡流与磁滞损耗
- 定子电流为对称三相正弦波
- 三相对称、绕组分布近似正弦

### 1.0 PMLSM 的基本结构与展开等效建模思想

在建立数学模型之前，有必要从结构与磁场分布的角度阐明 PMLSM 与旋转 PMSM 的对应关系。图 1 与图 2 分别从几何展开与行波磁场形成机理两个层面展示这一映射。

---

#### （1）旋转 PMSM 到 PMLSM 的展开等效关系

![1](../assets/figure/2026-01-23/1.png)

图 1 左侧为典型旋转永磁同步电机的横截面结构，其气隙磁场沿圆周方向呈周期分布；右侧为将圆周方向沿切向展开后得到的直线结构示意。

从建模角度而言，这一展开等效意味着：

- 旋转 PMSM 中的圆周坐标 $\theta_m$ 在 PMLSM 中对应为直线坐标 $x$
- 圆周方向的角度周期性转化为直线方向的空间周期性

在旋转 PMSM 中，气隙磁场沿圆周方向可表示为：

$$
B(\theta_m) = B_m \cos(n_p \theta_m)
$$

将其沿圆周方向展开后，磁场沿直线方向 $x$ 呈周期分布，可等效表示为：

$$
B(x) = B_m \cos\!\left( \frac{\pi}{\tau_p} x \right)
$$

其中：

- $\tau_p$ 为极距（一个 $N \rightarrow S$ 的距离）
- $2\tau_p$ 为极对距，对应一个完整电周期

由此建立核心等效关系：

$$
\theta_m \;\longleftrightarrow\; x
$$

这一对应关系构成了 PMLSM 数学建模能够直接复用 PMSM 坐标变换与 dq 模型形式的根本依据。

---

#### （2）三相绕组产生行波磁场的机理

![2](../assets/figure/2026-01-23/2.png)

图 2 展示了 PMLSM 中三相定子绕组在直线方向的分布形式，以及在三相对称电流激励下形成的行波磁场。

在该结构中：

- 定子沿 $x$ 方向周期性布置三相绕组  
- 绕组相序通常按 $A \rightarrow B \rightarrow C$ 或其等效顺序排列  
- 各相通入相位相差 $120^\circ$ 的对称正弦电流  

对应的三相电流可表示为：

$$
\begin{cases}
i_A = I_m \cos(\omega_e t), \\
i_B = I_m \cos\!\left(\omega_e t - \frac{2\pi}{3}\right), \\
i_C = I_m \cos\!\left(\omega_e t + \frac{2\pi}{3}\right).
\end{cases}
$$

由于绕组的物理位置在空间上也存在 $120^\circ$ 的等效电角度偏移，三相磁动势在直线方向叠加后，形成一个沿 $x$ 方向匀速移动的行波磁场。

该行波磁场的空间相位可用等效电角度表示为：

$$
\theta_e(x) = \frac{\pi}{\tau_p} x
$$

其传播速度（同步速度）为：

$$
v_s = \frac{\omega_e}{\pi/\tau_p}
$$

当动子速度 $v$ 与行波磁场速度一致时，电机处于同步运行状态，这正是 PMLSM 名称中"同步"的物理含义。

---

#### （3）从结构到数学模型的过渡

由图 1 和图 2 的分析可知：

- PMLSM 在结构上可视为旋转 PMSM 的空间展开形式
- 三相绕组产生的行波磁场，使得系统在数学上仍可引入等效电角度与电角速度：
  
$$
\theta_e = \frac{\pi}{\tau_p} x,
\qquad
\omega_e = \frac{\pi}{\tau_p} v
$$

因此，在后续建模中：

- Clarke / Park 坐标变换的形式保持不变  
- dq 电压方程与磁链方程形式保持不变  
- 仅需将机械角变量替换为直线位移变量  

这一结构—磁场—变量的映射关系，构成了 PMLSM 数学建模的物理基础。

---

### 1.1 三相电压方程

在自然坐标系（$ABC$）下，定子电压方程为：

$$
u_{3s} = R\,i_{3s} + \frac{d\psi_{3s}}{dt}
\tag{1}
$$

该方程形式与旋转 PMSM 完全一致，差异仅体现在磁链表达式中位置变量的定义：旋转电机采用电角度 $\theta_e$，直线电机则采用直线位移 $x$ 或其等效电角度 $\theta_e(x)$。

---

### 1.2 磁链方程

磁链方程可写为：

$$
\psi_{3s} = L_{3s} i_{3s} + \psi_f\, F_{3s}\big(\theta_e(x)\big)
\tag{2}
$$

其中永磁体磁链分布函数取为：

$$
F_{3s}(\theta_e)=
\begin{bmatrix}
\cos \theta_e \\
\cos\!\left(\theta_e - \frac{2\pi}{3}\right) \\
\cos\!\left(\theta_e + \frac{2\pi}{3}\right)
\end{bmatrix}
$$

建立直线电机的等效电角度是磁链方程的关键步骤。设 $\tau_p$ 为极距（pole pitch，N 极到 S 极的距离），则一个极对距为 $2\tau_p$。电角度每经过一个极对距增加 $2\pi$，因此有：

$$
\theta_e(x) = \frac{\pi}{\tau_p}\,x
\quad\Rightarrow\quad
\omega_e = \frac{d\theta_e}{dt} = \frac{\pi}{\tau_p}\,v
\tag{3}
$$

其中 $x$ 为动子（或等效磁场）在直线方向的位置，$v=\dot{x}$ 为线速度。

简言之：旋转 PMSM 的电角度来源于转子转角；PMLSM 的电角度来源于直线位移。

---

### 1.3 电磁推力方程

旋转电机的电磁转矩由能量法导出：

$$
T_e = \frac{\partial W'}{\partial \theta_m}
$$

直线电机的电磁推力对应为：

$$
F_e = \frac{\partial W'}{\partial x}
$$

由于 $\theta_e(x)=\frac{\pi}{\tau_p}x$，可得 $\frac{\partial}{\partial x}=\frac{\pi}{\tau_p}\frac{\partial}{\partial \theta_e}$。

在 dq 坐标系下，PMLSM 的电磁推力表达式与 PMSM 的转矩表达式具有一一对应关系：

$$
F_e = \frac{3}{2}\,\frac{\pi}{\tau_p}
\left[
\psi_f i_q + (L_d - L_q) i_d i_q
\right]
\tag{4}
$$

对于表贴式结构或磁阻效应较弱的电机，可近似取 $L_d=L_q$，此时推力表达式简化为：

$$
F_e = \frac{3}{2}\,\frac{\pi}{\tau_p}\,\psi_f i_q
\tag{5}
$$

从表达式结构可见，括号内的电磁部分 $\psi_f i_q + (L_d-L_q)i_di_q$ 与旋转 PMSM 完全同构；差异在于外部系数由极对数 $n_p$ 变为空间波数 $\pi/\tau_p$：

- 旋转电机：$\theta_e=n_p\theta_m\Rightarrow \partial/\partial \theta_m = n_p\,\partial/\partial \theta_e$
- 直线电机：$\theta_e=(\pi/\tau_p)x\Rightarrow \partial/\partial x = (\pi/\tau_p)\,\partial/\partial \theta_e$

---

### 1.4 机械运动方程

旋转 PMSM 的机械方程为：

$$
J\dot{\omega}_m = T_e - T_L - B\omega_m
$$

直线 PMLSM 的运动方程直接由质量与线速度表示：

$$
m\frac{dv}{dt} = F_e - F_L - B\,v
\tag{6}
$$

其中：  

- $m$：等效质量（动子与负载折算）  
- $F_L$：负载力（含坡度、摩擦、外扰等）
- $B$：粘性阻尼系数

---

## 二、PMLSM 的坐标变换

直线电机的三相绕组仍为 $ABC$ 三相系统，因此坐标变换的形式保持不变：

- Clarke 变换：$ABC \rightarrow \alpha\beta$
- Park 变换：$\alpha\beta \rightarrow dq$

与旋转 PMSM 的唯一区别在于：Park 变换的角度输入不再来自转子角传感器的 $\theta_e(t)$，而是来自位置 $x(t)$：

$$
\theta_e(t)=\theta_e(x(t))=\frac{\pi}{\tau_p}x(t)
\tag{7}
$$

在控制实现层面：旋转电机通常采用编码器获取角度信息；直线电机则采用直线编码器、光栅尺、磁栅或由观测器估计位置 $x$。

Clarke/Park 变换矩阵的具体形式可直接沿用 PMSM 建模中的标准定义。

---

## 三、PMLSM 在 dq 坐标系下的数学模型

本节给出 PMLSM 在 dq 同步旋转坐标系下的电压方程与磁链方程。该模型形式与旋转 PMSM 几乎完全一致，差异仅体现在电角速度的定义。

### 3.1 dq 电压方程

$$
\begin{cases}
u_d = R\,i_d + \dfrac{d\psi_d}{dt} - \omega_e\,\psi_q, \\
u_q = R\,i_q + \dfrac{d\psi_q}{dt} + \omega_e\,\psi_d.
\end{cases}
\tag{8}
$$

其中电角速度定义为：

$$
\omega_e = \frac{\pi}{\tau_p}v
\tag{9}
$$

### 3.2 磁链方程

$$
\begin{cases}
\psi_d = L_d\, i_d + \psi_f, \\
\psi_q = L_q\, i_q.
\end{cases}
\tag{10}
$$

将磁链方程代入电压方程，可得合并形式：

$$
\begin{bmatrix}
u_d \\ u_q
\end{bmatrix} =
\begin{bmatrix}
R & \omega_e L_q \\
-\omega_e L_d & R
\end{bmatrix}
\begin{bmatrix}
i_d \\ i_q
\end{bmatrix}
+
\frac{d}{dt}
\begin{bmatrix}
L_d & 0 \\ 0 & L_q
\end{bmatrix}
\begin{bmatrix}
i_d \\ i_q
\end{bmatrix}
+
\begin{bmatrix}
0 \\ \omega_e \psi_f
\end{bmatrix}
\tag{11}
$$

由此可见：除将 $\omega_e$ 替换为 $(\pi/\tau_p)v$ 外，PMLSM 的 dq 电磁模型与旋转 PMSM 完全同构。

---

## 四、与旋转 PMSM 的变量对应关系

将旋转 PMSM 中的变量按下表进行替换，即可得到直线 PMLSM 的对应形式：

| 旋转 PMSM                       | 直线 PMLSM                     | 物理说明             |
| ------------------------------- | ------------------------------ | -------------------- |
| 机械角 $\theta_m$               | 直线位移 $x$                   | 自由度从转动到平动   |
| 机械角速度 $\omega_m$           | 线速度 $v=\dot{x}$             | 速度定义变化         |
| 电角度 $\theta_e=n_p\theta_m$   | $\theta_e=\frac{\pi}{\tau_p}x$ | 电角度来源于空间周期 |
| 电角速度 $\omega_e=n_p\omega_m$ | $\omega_e=\frac{\pi}{\tau_p}v$ | 由速度直接映射       |
| 电磁转矩 $T_e$                  | 电磁推力 $F_e$                 | 输出物理量变化       |
| 转动惯量 $J$                    | 质量 $m$                       | 机械方程等效         |
| 负载转矩 $T_L$                  | 负载力 $F_L$                   | 外扰项变化           |

---

## 五、直线电机特有的扰动项

前述建模将 PMLSM 视为旋转 PMSM 的空间展开形式，在理想假设下二者的电磁方程高度同构。然而，直线电机因其开放式结构，存在若干旋转电机所不具备的扰动特性。本节讨论端部效应、齿槽推力与法向力等直线电机特有的扰动项，这些因素在高精度定位与平稳运行场合不可忽视。

### 5.1 端部效应

端部效应是直线电机区别于旋转电机的本质特征之一。旋转电机的定子与转子均为闭合结构，磁路在圆周方向连续；而直线电机的初级（定子）或次级（动子）在行程方向存在物理边界，导致磁场在端部区域发生畸变。

根据产生机理，端部效应可分为以下两类：

**（1）纵向端部效应**
当初级长度有限时，初级铁芯在两端形成磁路断口。行波磁场在进入与离开初级区域时，磁通路径发生突变，导致：

- 气隙磁场沿行程方向的分布不再均匀，偏离理想正弦假设
- 进入端与退出端产生的推力分量不相等，形成与速度相关的附加制动力
- 端部区域的磁场畸变引发附加涡流损耗，降低电机效率
- 推力在端部区域出现周期性波动，影响运行平稳性

对于短初级长次级结构（动圈式），该效应相对固定；对于长初级短次级结构（动磁式），端部效应随动子位置变化，其影响更为复杂。

**（2）横向边缘效应**
当初级或次级在垂直于运动方向的宽度有限时，磁场在横向边缘发生泄漏与畸变。该效应导致：

- 有效气隙磁场降低
- 推力常数下降
- 边缘区域产生不均匀的磁拉力

横向边缘效应的影响程度与电机的宽长比及气隙大小密切相关。

---

### 5.2 齿槽推力

齿槽推力（Cogging Force）是由永磁体与定子齿槽相互作用产生的位置相关扰动力。其产生机理与旋转电机中的齿槽转矩相同，但在直线电机中表现为沿运动方向的周期性推力波动。

齿槽推力可表示为位移的周期函数：

$$
F_{cog}(x) = \sum_{k=1}^{\infty} F_k \sin\!\left( \frac{2\pi k}{\tau_{cog}} x + \phi_k \right)
\tag{12}
$$

其中 $\tau_{cog}$ 为齿槽推力的空间周期，与极距 $\tau_p$ 和齿距的最小公倍数相关。

齿槽推力的特点包括：

- 与负载电流无关，在零电流时仍然存在
- 周期与极距、齿距的几何关系决定
- 在低速运行时对定位精度影响显著

工程上常采用斜槽、分数槽绕组、磁极偏移等方法削弱齿槽推力。

---

### 5.3 推力波动

除齿槽推力外，PMLSM 在通电运行时还存在与电流相关的推力波动，主要来源包括：

- 电流谐波与反电动势谐波的相互作用
- 磁场非正弦分布引起的磁链谐波
- 逆变器死区效应与开关谐波

推力波动可分解为与电角度相关的周期分量：

$$
F_{ripple}(\theta_e) = \sum_{n} F_n \cos(n\theta_e + \varphi_n)
\tag{13}
$$

在直线电机中，$\theta_e = (\pi/\tau_p)x$，因此推力波动表现为空间位置的周期性扰动，其频率随运行速度变化。

---

### 5.4 法向力与导向力

直线电机在产生切向推力的同时，气隙磁场还会产生法向吸力（Normal Force）。对于平板式 PMLSM，法向力表现为初级与次级之间的吸引力。

法向力的量级通常为切向推力的数倍至十余倍，其特点包括：

- 平均分量：由永磁体与铁芯的磁吸引产生，与电流无关
- 波动分量：与位置相关，周期与齿槽推力类似

法向力本身不做机械功，但对导向机构产生载荷，影响系统的机械设计与动态性能。在 U 型或双边结构中，可通过对称布置使法向力相互抵消。

---

### 5.5 扰动项的建模处理

在实际控制系统设计中，上述扰动项可归纳为集总扰动 $F_d$，机械方程相应修正为：

$$
m\frac{dv}{dt} = F_e - F_L - B\,v - F_d
\tag{14}
$$

其中 $F_d$ 包含端部效应引起的推力波动、齿槽推力、推力脉动等分量。

扰动项的处理策略通常包括：

- **前馈补偿**：基于离线标定或有限元仿真结果，建立扰动力与位置的映射表，实施前馈抵消
- **观测器估计**：采用扩展状态观测器（ESO）或扰动观测器（DOB）在线估计并补偿
- **结构优化**：从电机本体设计层面削弱扰动源

对于高精度伺服应用，上述扰动项的建模与补偿是实现平稳运行的关键环节。

---

## 六、总结

- **电磁侧（ABC/αβ/dq）**：PMLSM 与 PMSM 的方程形式高度同构，Clarke/Park 变换矩阵可直接复用。  
- **机械侧（输出与动力学）**：由转矩 $T$、惯量 $J$、角速度 $\omega$ 变为推力 $F$、质量 $m$、线速度 $v$。  
- **直线电机特有量**：极距 $\tau_p$（或极对距 $2\tau_p$）决定等效电角度 $\theta_e(x)$ 与电角速度 $\omega_e(v)$，并出现在推力系数 $\pi/\tau_p$ 中。  
- **控制层面**：掌握 PMSM 的磁场定向控制（FOC）方法后，PMLSM 的 FOC 实现本质上是将角度来源替换为位置，将转矩环替换为推力/速度/位置环。
